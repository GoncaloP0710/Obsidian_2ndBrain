2025-01-08 15:03

Status: #done 

Tags: [[Software Security]] [[Code Analysis]] 

# Control-flow analysis

Basic idea is to follow the control paths of a program doing checks.
- can be performed at the function/module/program level

Detects problems like:
- invalid pointer references, use of uninitialized memory, improper operations on resources like files.

### Simulating a path
Traversing the AST of the function and evaluating the relevant instructions. In the end, the state of the memory is summarized.

In alternative to the AST, one can build a control flow graph and follow the various paths over the graph.

### Control Flow Graph
A control flow graph is a directed graph G=(V, E), where u, v ϵ V are basic blocks and an edge e ϵ E : u → v represents a possible flow of control from u to v.

- **basic blocks** is a group of instructions that are always executed in sequence and there are no jumps to the middle of them
- **edges** represent potential control flow paths between basic blocks
- **back edges** represent loops
- **trace** is a sequence of basic blocks that define a path through the code

A **model** is used to represent the outcome of an external function to the program.

Models can also be created by the tool for the functions of the program, so that they can be used during the analysis of functions that call them.

Local analysis
- analyses one function at a time 
- does not consider the relations among them

Module-level analysis
- one class / compilation unit at a time based on the models generated by local analysis
- does not consider relations among modules

Global analysis
- analysis the whole program, given the previous analysis of functions and modules ⇾ you can use a **call graph**

### Call Graph
A call graph represents potential control flow between functions or methods

![[Control-flow analysis 1.png]]

# References

https://moodle.ciencias.ulisboa.pt/pluginfile.php/554479/mod_resource/content/7/T_StaticA.pdf